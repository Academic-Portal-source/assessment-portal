<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Assessment Portal</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-50">
    <div id="root"></div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, doc, setDoc, getDoc, collection, onSnapshot, addDoc, deleteDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // ðŸ›‘ STEP 1: PASTE YOUR FIREBASE KEYS HERE ðŸ›‘
        const firebaseConfig = {
  apiKey: "AIzaSyALMgvcCfYCQVBZy3Kxv0r6vUx_gyoqYGg",
  authDomain: "assessment-portal-27ad3.firebaseapp.com",
  projectId: "assessment-portal-27ad3",
  storageBucket: "assessment-portal-27ad3.firebasestorage.app",
  messagingSenderId: "539434351950",
  appId: "1:539434351950:web:c9a68dc8003d3f83d1f21f",
  measurementId: "G-LBBRXQ1RJH"
};

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        
        // Make available to React
        window.FB = { auth, db, collection, doc, setDoc, getDoc, onSnapshot, addDoc, deleteDoc, signInAnonymously, onAuthStateChanged };
    </script>

    <script type="text/babel">
        const { useState, useEffect } = React;

        function App() {
            const [view, setView] = useState('login');
            const [admissionNo, setAdmissionNo] = useState('');
            const [questions, setQuestions] = useState([]);
            const [modules, setModules] = useState([]);
            const [user, setUser] = useState(null);

            useEffect(() => {
                const { auth, db, onAuthStateChanged, signInAnonymously, onSnapshot, collection } = window.FB;
                signInAnonymously(auth);
                onAuthStateChanged(auth, (u) => {
                    if (u) {
                        setUser(u);
                        onSnapshot(collection(db, 'questions'), s => setQuestions(s.docs.map(d => ({id:d.id, ...d.data()}))));
                        onSnapshot(collection(db, 'modules'), s => setModules(s.docs.map(d => ({id:d.id, ...d.data()}))));
                    }
                });
            }, []);

            return (
                <div className="max-w-2xl mx-auto p-6">
                    <nav className="flex justify-between items-center mb-8">
                        <h1 className="text-2xl font-bold text-indigo-600">EduPortal</h1>
                        <button onClick={() => setView('admin')} className="text-slate-300 text-xs font-bold">ADMIN</button>
                    </nav>

                    {view === 'login' && (
                        <div className="bg-white p-8 rounded-2xl shadow-xl border">
                            <h2 className="text-xl font-bold mb-4 text-center">Student Access</h2>
                            <input 
                                className="w-full border p-3 rounded-xl mb-4 uppercase" 
                                placeholder="STU-123" 
                                onChange={e => setAdmissionNo(e.target.value)}
                            />
                            <button onClick={() => setView('dashboard')} className="w-full bg-indigo-600 text-white p-3 rounded-xl font-bold">Start Assessment</button>
                        </div>
                    )}

                    {view === 'dashboard' && (
                        <div className="text-center">
                            <h2 className="text-2xl font-bold">Welcome, {admissionNo}!</h2>
                            <div className="grid gap-4 mt-6">
                                <button className="bg-white p-6 rounded-2xl border-2 border-slate-100 hover:border-indigo-500 font-bold">Standard Quiz ({questions.length})</button>
                                {modules.map(m => (
                                    <button key={m.id} className="bg-white p-6 rounded-2xl border-2 border-slate-100 hover:border-emerald-500 font-bold text-emerald-600">{m.name}</button>
                                ))}
                            </div>
                            <button onClick={() => setView('login')} className="mt-8 text-slate-400">Logout</button>
                        </div>
                    )}

                    {view === 'admin' && (
                        <div className="bg-white p-6 rounded-2xl border shadow">
                            <h2 className="font-bold text-lg mb-4">Admin Dashboard</h2>
                            <p className="text-sm text-slate-500 mb-6 italic">Configuration loaded successfully.</p>
                            <button onClick={() => setView('login')} className="bg-slate-100 px-4 py-2 rounded-lg font-bold">Back to Login</button>
                        </div>
                    )}
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>